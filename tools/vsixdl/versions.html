<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <title>VSCode æ‰©å±• VSIX å†å²ç‰ˆæœ¬ä¸‹è½½å™¨ - Vanadiry</title>
    <link rel="stylesheet" href="style.css">
    <script src="/assets/control.js"></script>

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="VSCode æ‰©å±•ä¸‹è½½å™¨ï¼Œå¿«é€Ÿè·å– Visual Studio Code æ’ä»¶ç‰ˆæœ¬ä¸ç¦»çº¿å®‰è£…åŒ…ï¼Œæ”¯æŒå†å²ç‰ˆæœ¬æŸ¥çœ‹ï¼Œé€‚åˆæ— æ³•è®¿é—®å®˜æ–¹æºçš„ç”¨æˆ·ä½¿ç”¨ã€‚">
    <meta name="keywords" content="VSCode æ‰©å±•, VSCode æ’ä»¶ä¸‹è½½, Visual Studio Code Extensions, VSIX, VSCode å†å²ç‰ˆæœ¬, Vanadiry">
    <meta name="author" content="Vanadiry">
    <meta name="robots" content="index,follow">
    <meta property="og:title" content="VSCode æ‰©å±• VSIX å†å²ç‰ˆæœ¬ä¸‹è½½å™¨ - Vanadiry">
    <meta property="og:description" content="VSCode æ‰©å±•ä¸‹è½½å™¨ï¼Œå¿«é€Ÿè·å– Visual Studio Code æ’ä»¶ç‰ˆæœ¬ä¸ç¦»çº¿å®‰è£…åŒ…ï¼Œæ”¯æŒå†å²ç‰ˆæœ¬æŸ¥çœ‹ï¼Œé€‚åˆæ— æ³•è®¿é—®å®˜æ–¹æºçš„ç”¨æˆ·ä½¿ç”¨ã€‚">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://vanadiry.com/tools/vsixdl/version.html">
    <meta property="og:image" content="https://data.vanadiry.com/site/siteicon.png">
    <meta name="theme-color" content="#ffffff">
    <link rel="icon" type="image/x-icon" href="https://data.vanadiry.com/site/favicon.ico">
</head>

<body>
    <div class="container">
        <h2 id="title">ğŸ‰ VSCode æ‰©å±•ä¸‹è½½å™¨ - å†å²ç‰ˆæœ¬</h2>
        <a class="back-home" href="index.html">â† è¿”å›ä¸»é¡µ</a>

        <div class="card" id="ext-card" style="display:none;">
            <div class="header-row">
                <img class="logo" id="ext-logo" src="" alt="logo"
                    onerror="this.src='data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 width=%2260%22 height=%2260%22><rect width=%2260%22 height=%2260%22 rx=%228%22 fill=%22%23999%22/><text x=%2230%22 y=%2238%22 text-anchor=%22middle%22 font-size=%2230%22 fill=%22white%22>?</text></svg>'">
                <div>
                    <div class="card-title" id="ext-name"></div>
                    <div class="card-sub" id="ext-publisher"></div>
                    <div class="info-text" id="ext-id"></div>
                </div>
            </div>
            <div class="card-desc" id="ext-desc"></div>
            <div class="info-text">
                <b>ä¸Šæ¬¡æ›´æ–°ï¼š</b><code><span id="meta-updated"></span></code><br />
                <b>å‘å¸ƒæ—¥æœŸï¼š</b><code><span id="meta-release"></code></span>
            </div>
        </div>
        <br />
        <div class="card">
            <h3>å†å²ç‰ˆæœ¬</h3>
            <div class="info-text" id="versions-count"></div>
            <table>
                <tbody id="versions-body">
                    <tr>
                        <td colspan="4">æ­£åœ¨åŠ è½½ç‰ˆæœ¬ä¿¡æ¯...</td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="info-text" id="status-msg"></div>
        <footer class="site-footer">
            Â© 2026 <a href="https://vanadiry.com/">Vanadiry</a> ç‰ˆæƒæ‰€æœ‰
        </footer>

    </div>
    <script>
        function getQueryExt() {
            const p = new URLSearchParams(location.search);
            const raw = p.get("ext") || "";
            const parts = raw.split(".");
            if (parts.length !== 2) return null;
            return { publisher: parts[0], extension: parts[1] };
        }
        function fmt(t) {
            if (!t) return "-";
            const d = new Date(t);
            return isNaN(d) ? t : d.toLocaleString();
        }
        async function fetchDetail(pub, ext) {
            const body = {
                filters: [
                    {
                        criteria: [
                            { filterType: 7, value: pub + "." + ext },
                            { filterType: 8, value: "Microsoft.VisualStudio.Code" },
                            { filterType: 12, value: "4096" }
                        ],
                        pageNumber: 1,
                        pageSize: 1
                    }
                ],
                flags: 55
            };
            const res = await fetch("https://marketplace.visualstudio.com/_apis/public/gallery/extensionquery", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                    "Accept": "application/json;api-version=3.0-preview.1",
                    "User-Agent": "VSCode",
                    "X-Market-Client-Id": "VSCode"
                },
                body: JSON.stringify(body)
            });
            const data = await res.json();
            return data?.results?.[0]?.extensions?.[0] || null;
        }
        function render(ext) {
            document.getElementById("ext-card").style.display = "block";
            document.getElementById("ext-name").textContent = ext.displayName || ext.extensionName;
            document.getElementById("ext-publisher").textContent =
                "å¼€å‘è€…ï¼š" + (ext.publisher.displayName || ext.publisher.publisherName);
            document.getElementById("ext-id").textContent = ext.publisher.publisherName + "." + ext.extensionName;
            document.getElementById("ext-desc").textContent = ext.shortDescription || "";
            document.getElementById("meta-updated").textContent = fmt(ext.lastUpdated);
            document.getElementById("meta-release").textContent = fmt(ext.releaseDate);
            let logo = "";
            if (ext.versions[0]?.files) {
                const f = ext.versions[0].files.find(x => x.assetType === "Microsoft.VisualStudio.Services.Icons.Default");
                if (f) logo = f.source;
            }
            if (logo) document.getElementById("ext-logo").src = logo;
            const tbody = document.getElementById("versions-body");
            tbody.innerHTML = "";
            const versions = ext.versions.sort((a, b) => new Date(b.lastUpdated) - new Date(a.lastUpdated));
            document.getElementById("versions-count").textContent = `å…± ${versions.length} ä¸ªç‰ˆæœ¬`;
            versions.forEach(v => {
                const tr = document.createElement("tr");
                const vsix = (v.files || []).find(f => f.assetType === "Microsoft.VisualStudio.Services.VSIXPackage");
                tr.innerHTML = `
        <td>
          ${vsix
                        ? `<a class="download-btn" href="${vsix.source}" download="${ext.publisher.publisherName}.${ext.extensionName}-${v.version}.vsix">ä¸‹è½½</a>`
                        : `<span class="download-btn disabled">æ— æ–‡ä»¶</span>`
                    }
        </td>
        <td><span class="version-badge">${v.version}</span></td>
        <td>${fmt(v.lastUpdated)}</td>
      `;
                tbody.appendChild(tr);
            });
        }
        async function init() {
            const info = getQueryExt();
            if (!info) {
                const el = document.getElementById("status-msg");
                el.innerHTML = 'ç¼ºå°‘å‚æ•°æˆ–å‚æ•°é”™è¯¯<br />è¯·å…ˆä» <a href="index.html">æ‰©å±•ä¸‹è½½å™¨ä¸»é¡µ</a> æœç´¢ï¼Œæˆ–è€…ä¼ å…¥å‚æ•° ext=publisher.extension';
                el.style.display = "block";
                return;
            }
            try {
                const ext = await fetchDetail(info.publisher, info.extension);
                if (!ext) throw new Error("æ²¡æœ‰æ‰¾åˆ°è¿™ä¸ªæ‰©å±•ï¼Œæ£€æŸ¥ä¼ å…¥å‚æ•°æ˜¯å¦æ­£ç¡®ï¼Ÿ");
                render(ext);
            } catch (e) {
                document.getElementById("status-msg").textContent = e.message;
                document.getElementById("status-msg").style.display = "block";
            }
        }
        init();
    </script>
</body>

</html>